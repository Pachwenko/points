import{s as $,e as W,i as H,z as X,d as E,A as ee,o as te,f as m,a as U,g as h,h as L,c as D,u as O,j as s,v as r,E as q,C as j,F as ae,l as se,m as le,n as ne}from"../chunks/scheduler.wCkDe2Ta.js";import{S as re,i as ie}from"../chunks/index.LId1ysqj.js";import{g as G}from"../chunks/navigation.sly37ktX.js";import{p as oe}from"../chunks/stores.Mvdeo-Rc.js";function Y(l){let a,e,t,n,i,v="Display Name",N,u,I,o,b,y="Email",k,g,B,w,C,A="New Password",c,d,T,S,J="Save Changes",z,P,K="Sign out",R,Q,f=l[1]&&Z(l);return{c(){a=m("div"),e=m("form"),f&&f.c(),t=U(),n=m("div"),i=m("label"),i.textContent=v,N=U(),u=m("input"),I=U(),o=m("div"),b=m("label"),b.textContent=y,k=U(),g=m("input"),B=U(),w=m("div"),C=m("label"),C.textContent=A,c=U(),d=m("input"),T=U(),S=m("button"),S.textContent=J,z=U(),P=m("button"),P.textContent=K,this.h()},l(p){a=h(p,"DIV",{class:!0});var x=L(a);e=h(x,"FORM",{class:!0});var _=L(e);f&&f.l(_),t=D(_),n=h(_,"DIV",{class:!0});var V=L(n);i=h(V,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(i)!=="svelte-xvxr5t"&&(i.textContent=v),N=D(V),u=h(V,"INPUT",{id:!0,name:!0,class:!0,placeholder:!0}),V.forEach(E),I=D(_),o=h(_,"DIV",{class:!0});var M=L(o);b=h(M,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(b)!=="svelte-5n7jdk"&&(b.textContent=y),k=D(M),g=h(M,"INPUT",{id:!0,name:!0,class:!0,placeholder:!0}),M.forEach(E),B=D(_),w=h(_,"DIV",{class:!0});var F=L(w);C=h(F,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(C)!=="svelte-12yjkt4"&&(C.textContent=A),c=D(F),d=h(F,"INPUT",{id:!0,name:!0,class:!0,placeholder:!0}),F.forEach(E),T=D(_),S=h(_,"BUTTON",{class:!0,"data-svelte-h":!0}),O(S)!=="svelte-1ibyomg"&&(S.textContent=J),z=D(_),P=h(_,"BUTTON",{class:!0,"data-svelte-h":!0}),O(P)!=="svelte-1k2o8tq"&&(P.textContent=K),_.forEach(E),x.forEach(E),this.h()},h(){s(i,"for","display-name"),s(i,"class","block mb-2"),s(u,"id","display-name"),s(u,"name","display_name"),s(u,"class","w-full p-2 text-gray-900 bg-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"),s(u,"placeholder","Display Name"),s(n,"class","mb-4"),s(b,"for","email"),s(b,"class","block mb-2"),s(g,"id","email"),s(g,"name","email"),s(g,"class","w-full p-2 text-gray-900 bg-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"),s(g,"placeholder","me@example.com"),s(o,"class","mb-4"),s(C,"for","password"),s(C,"class","block mb-2"),s(d,"id","password"),s(d,"name","password"),s(d,"class","w-full p-2 text-gray-900 bg-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"),s(d,"placeholder","new password"),s(w,"class","mb-4"),s(S,"class","w-full p-3 bg-aqua text-white rounded-lg hover:bg-dim-aqua"),s(P,"class","w-full mt-4 p-3 bg-red-500 text-white rounded-lg hover:bg-red-600"),s(e,"class","p-6 rounded-lg w-full max-w-md"),s(a,"class","h-full flex justify-center items-center")},m(p,x){H(p,a,x),r(a,e),f&&f.m(e,null),r(e,t),r(e,n),r(n,i),r(n,N),r(n,u),q(u,l[2]),r(e,I),r(e,o),r(o,b),r(o,k),r(o,g),q(g,l[3]),r(e,B),r(e,w),r(w,C),r(w,c),r(w,d),q(d,l[4]),r(e,T),r(e,S),r(e,z),r(e,P),R||(Q=[j(u,"input",l[9]),j(g,"input",l[10]),j(d,"input",l[11]),j(P,"click",l[6]),j(e,"submit",l[5])],R=!0)},p(p,x){p[1]?f?f.p(p,x):(f=Z(p),f.c(),f.m(e,t)):f&&(f.d(1),f=null),x&4&&u.value!==p[2]&&q(u,p[2]),x&8&&g.value!==p[3]&&q(g,p[3]),x&16&&d.value!==p[4]&&q(d,p[4])},d(p){p&&E(a),f&&f.d(),R=!1,ae(Q)}}}function Z(l){let a,e;return{c(){a=m("p"),e=se(l[1]),this.h()},l(t){a=h(t,"P",{class:!0});var n=L(a);e=le(n,l[1]),n.forEach(E),this.h()},h(){s(a,"class","text-2xl text-center border border-2")},m(t,n){H(t,a,n),r(a,e)},p(t,n){n&2&&ne(e,t[1])},d(t){t&&E(a)}}}function ue(l){let a,e=l[0].session&&Y(l);return{c(){e&&e.c(),a=W()},l(t){e&&e.l(t),a=W()},m(t,n){e&&e.m(t,n),H(t,a,n)},p(t,[n]){t[0].session?e?e.p(t,n):(e=Y(t),e.c(),e.m(a.parentNode,a)):e&&(e.d(1),e=null)},i:X,o:X,d(t){t&&E(a),e&&e.d(t)}}}function de(l,a,e){let t,n;ee(l,oe,c=>e(8,n=c));let{data:i}=a,{supabase:v}=i,N="",u,I="",o="",b="",y="",k="";async function g(){let c=!1;if(o!==I)if(u){const{error:d}=await i.supabase.from("profiles").update({display_name:o}).eq("id",i.session?.user.id);c=!d}else{const{error:d}=await v.from("profiles").insert({id:i.session?.user.id,display_name:o});c=!d}k&&await v.auth.updateUser({password:k}),y!==b&&(await v.auth.updateUser({email:y}),e(1,N+="Please go to your email and confirm the change.")),t&&c&&G("/")}const B=async()=>{await v.auth.signOut(),G("/auth")};te(async()=>{i.session||G("/auth");const{data:c,error:d}=await v.from("profiles").select("*").eq("id",i.session?.user.id).maybeSingle();c?(u=c,e(2,o=u.display_name),I=o):(u=null,e(2,o=""),I="");const{data:{user:T}}=await v.auth.getUser();T&&(e(3,y=T.email),b=y)});function w(){o=this.value,e(2,o)}function C(){y=this.value,e(3,y)}function A(){k=this.value,e(4,k)}return l.$$set=c=>{"data"in c&&e(0,i=c.data)},l.$$.update=()=>{l.$$.dirty&1&&({supabase:v}=i),l.$$.dirty&256&&e(7,t=n.url.searchParams.get("msg")||""),l.$$.dirty&130&&e(1,N=t||N)},[i,N,o,y,k,g,B,t,n,w,C,A]}class he extends re{constructor(a){super(),ie(this,a,de,ue,$,{data:0})}}export{he as component};
