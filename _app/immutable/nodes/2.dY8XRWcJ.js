import{s as F,c as K,f as j,u as Q,g as R,d as X,h as T,i as Y,j as Z,e as q,o as ee,n as te}from"../chunks/scheduler.qjSdMX96.js";import{S as G,i as J,g,h as v,j as y,f as p,z as w,a as D,A as se,d as E,t as U,e as B,b as ne,s as S,r as le,x as L,c as C,u as ae,k as P,y as m,v as oe,w as ie,m as I,n as V,B as re,o as H,p as ce}from"../chunks/index.Asz5LQEO.js";import{e as M,c as N,a as x}from"../chunks/store.674mkOx1.js";import{g as $}from"../chunks/navigation.Om4PnJII.js";function ue(r,e){const t={},s={},i={$$scope:1};let a=r.length;for(;a--;){const l=r[a],c=e[a];if(c){for(const f in l)f in c||(s[f]=1);for(const f in c)i[f]||(t[f]=c[f],i[f]=1);r[a]=c}else for(const f in l)i[f]=1}for(const l in s)l in t||(t[l]=void 0);return t}function fe(r){let e,t,s,i;const a=r[3].default,l=K(a,r,r[2],null);let c=[{class:r[0]},r[1]],f={};for(let n=0;n<c.length;n+=1)f=j(f,c[n]);return{c(){e=g("button"),l&&l.c(),this.h()},l(n){e=v(n,"BUTTON",{class:!0});var u=y(e);l&&l.l(u),u.forEach(p),this.h()},h(){w(e,f)},m(n,u){D(n,e,u),l&&l.m(e,null),e.autofocus&&e.focus(),t=!0,s||(i=se(e,"click",r[4]),s=!0)},p(n,[u]){l&&l.p&&(!t||u&4)&&Q(l,a,n,n[2],t?X(a,n[2],u,null):R(n[2]),null),w(e,f=ue(c,[(!t||u&1)&&{class:n[0]},u&2&&n[1]]))},i(n){t||(E(l,n),t=!0)},o(n){U(l,n),t=!1},d(n){n&&p(e),l&&l.d(n),s=!1,i()}}}function de(r,e,t){const s=["classes"];let i=T(e,s),{$$slots:a={},$$scope:l}=e,{classes:c="bg-transparent border border-solid border-dim-orange hover:bg-dim-orange text-foreground font-bold m-2 py-2 px-4 rounded active:bg-orange ease-linear transition-all duration-150"}=e;function f(n){Z.call(this,r,n)}return r.$$set=n=>{e=j(j({},e),Y(n)),t(1,i=T(e,s)),"classes"in n&&t(0,c=n.classes),"$$scope"in n&&t(2,l=n.$$scope)},[c,i,l,a,f]}class _e extends G{constructor(e){super(),J(this,e,de,fe,F,{classes:0})}}function A(r,e,t){const s=r.slice();return s[6]=e[t],s}function O(r){let e,t,s,i="Welcome to Pointing Poker",a,l,c,f,n;function u(_,k){return _[1]?me:he}let h=u(r),d=h(r);c=new _e({props:{$$slots:{default:[pe]},$$scope:{ctx:r}}}),c.$on("click",r[3]);let o=r[2]&&z(r);return{c(){e=g("div"),t=g("div"),s=g("h1"),s.textContent=i,a=S(),d.c(),l=S(),le(c.$$.fragment),f=S(),o&&o.c(),this.h()},l(_){e=v(_,"DIV",{class:!0});var k=y(e);t=v(k,"DIV",{class:!0});var b=y(t);s=v(b,"H1",{class:!0,"data-svelte-h":!0}),L(s)!=="svelte-1c2fdh4"&&(s.textContent=i),a=C(b),d.l(b),l=C(b),ae(c.$$.fragment,b),f=C(b),o&&o.l(b),b.forEach(p),k.forEach(p),this.h()},h(){P(s,"class","text-center text-3xl font-bold"),P(t,"class","container mx-auto p-2 text-center"),P(e,"class","p-8 min-h-full flex flex-col flex-grow justify-center items-center")},m(_,k){D(_,e,k),m(e,t),m(t,s),m(t,a),d.m(t,null),m(t,l),oe(c,t,null),m(t,f),o&&o.m(t,null),n=!0},p(_,k){h===(h=u(_))&&d?d.p(_,k):(d.d(1),d=h(_),d&&(d.c(),d.m(t,l)));const b={};k&512&&(b.$$scope={dirty:k,ctx:_}),c.$set(b),_[2]?o?o.p(_,k):(o=z(_),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},i(_){n||(E(c.$$.fragment,_),n=!0)},o(_){U(c.$$.fragment,_),n=!1},d(_){_&&p(e),d.d(),ie(c),o&&o.d()}}}function he(r){let e,t="Display name: loading...";return{c(){e=g("div"),e.textContent=t},l(s){e=v(s,"DIV",{"data-svelte-h":!0}),L(e)!=="svelte-1ar43gj"&&(e.textContent=t)},m(s,i){D(s,e,i)},p:te,d(s){s&&p(e)}}}function me(r){let e,t,s,i=r[1].display_name+"",a;return{c(){e=g("div"),t=I("Display name: "),s=g("p"),a=I(i),this.h()},l(l){e=v(l,"DIV",{});var c=y(e);t=V(c,"Display name: "),s=v(c,"P",{class:!0});var f=y(s);a=V(f,i),f.forEach(p),c.forEach(p),this.h()},h(){P(s,"class","text-aqua font-bold")},m(l,c){D(l,e,c),m(e,t),m(e,s),m(s,a)},p(l,c){c&2&&i!==(i=l[1].display_name+"")&&H(a,i)},d(l){l&&p(e)}}}function pe(r){let e;return{c(){e=I("Start new Pointing Session")},l(t){e=V(t,"Start new Pointing Session")},m(t,s){D(t,e,s)},d(t){t&&p(e)}}}function z(r){let e,t,s="Previous Sessions:",i,a,l,c="<div>Session ID</div> <div>Last Used</div>",f,n=M(r[2]),u=[];for(let h=0;h<n.length;h+=1)u[h]=W(A(r,n,h));return{c(){e=g("div"),t=g("h4"),t.textContent=s,i=S(),a=g("ul"),l=g("li"),l.innerHTML=c,f=S();for(let h=0;h<u.length;h+=1)u[h].c();this.h()},l(h){e=v(h,"DIV",{class:!0});var d=y(e);t=v(d,"H4",{class:!0,"data-svelte-h":!0}),L(t)!=="svelte-1r56ubk"&&(t.textContent=s),i=C(d),a=v(d,"UL",{});var o=y(a);l=v(o,"LI",{class:!0,"data-svelte-h":!0}),L(l)!=="svelte-1r9llr4"&&(l.innerHTML=c),f=C(o);for(let _=0;_<u.length;_+=1)u[_].l(o);o.forEach(p),d.forEach(p),this.h()},h(){P(t,"class","text-2xl font-bold"),P(l,"class","grid grid-cols-2"),P(e,"class","w-full")},m(h,d){D(h,e,d),m(e,t),m(e,i),m(e,a),m(a,l),m(a,f);for(let o=0;o<u.length;o+=1)u[o]&&u[o].m(a,null)},p(h,d){if(d&4){n=M(h[2]);let o;for(o=0;o<n.length;o+=1){const _=A(h,n,o);u[o]?u[o].p(_,d):(u[o]=W(_),u[o].c(),u[o].m(a,null))}for(;o<u.length;o+=1)u[o].d(1);u.length=n.length}},d(h){h&&p(e),re(u,h)}}}function W(r){let e,t,s,i=r[6].id+"",a,l,c,f=r[6].last_updated+"",n,u,h;return{c(){e=g("li"),t=g("a"),s=g("div"),a=I(i),l=S(),c=g("div"),n=I(f),h=S(),this.h()},l(d){e=v(d,"LI",{});var o=y(e);t=v(o,"A",{class:!0,href:!0});var _=y(t);s=v(_,"DIV",{});var k=y(s);a=V(k,i),k.forEach(p),l=C(_),c=v(_,"DIV",{});var b=y(c);n=V(b,f),b.forEach(p),_.forEach(p),h=C(o),o.forEach(p),this.h()},h(){P(t,"class","grid grid-cols-2 border border-1 rounded m-1 p-1"),P(t,"href",u="/points/"+r[6].id+"/")},m(d,o){D(d,e,o),m(e,t),m(t,s),m(s,a),m(t,l),m(t,c),m(c,n),m(e,h)},p(d,o){o&4&&i!==(i=d[6].id+"")&&H(a,i),o&4&&f!==(f=d[6].last_updated+"")&&H(n,f),o&4&&u!==(u="/points/"+d[6].id+"/")&&P(t,"href",u)},d(d){d&&p(e)}}}function ge(r){let e,t,s=r[0].session&&O(r);return{c(){s&&s.c(),e=B()},l(i){s&&s.l(i),e=B()},m(i,a){s&&s.m(i,a),D(i,e,a),t=!0},p(i,[a]){i[0].session?s?(s.p(i,a),a&1&&E(s,1)):(s=O(i),s.c(),E(s,1),s.m(e.parentNode,e)):s&&(ce(),U(s,1,1,()=>{s=null}),ne())},i(i){t||(E(s),t=!0)},o(i){U(s),t=!1},d(i){i&&p(e),s&&s.d(i)}}}function ve(r,e,t){let s,i;q(r,x,n=>t(1,s=n)),q(r,N,n=>t(2,i=n));let{data:a}=e,{supabase:l}=a;async function c(){const n={version:1,activePlayers:{}};n[a.session.user.is]={id:a.session.user.id,displayName:s.display_name,currentVote:""},l.from("PointingSession").insert({last_updated:new Date().toISOString(),game_state:n,users:[a.session.user.id]}).select().single().then(u=>{console.log("started new session",u),u.data&&$(`/points/${u.data.id}`)})}async function f(){l.from("PointingSession").select().contains("users",[a.session?.user.id]).order("last_updated",{ascending:!1}).then(n=>{N.set(n.data)}),l.from("profiles").select("*").eq("id",a.session?.user.id).limit(1).single().then(n=>{console.log("profile",n),n?.data?x.set(n.data):x.set({display_name:"default",temporary:!0})})}return ee(async()=>{a.session||$("/auth")}),r.$$set=n=>{"data"in n&&t(0,a=n.data)},r.$$.update=()=>{r.$$.dirty&1&&({supabase:l}=a),r.$$.dirty&1&&a.session&&f()},[a,s,i,c]}class De extends G{constructor(e){super(),J(this,e,ve,ge,F,{data:0})}}export{De as component};
